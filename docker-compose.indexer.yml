version: "3.8"

services:
  indexer:
    container_name: "midnight-indexer"
    image: "midnightntwrk/indexer-standalone:2.1.1"
    ports:
      - "8088:8088" # GraphQL APIポート
    environment:
      RUST_LOG: "indexer=info,chain_indexer=info,indexer_api=info,wallet_indexer=info,indexer_common=info"
      # 32バイトのランダムな16進数エンコードされたシークレット（開発用）
      # 注意: 本番環境では適切なシークレットを生成してください
      APP__INFRA__SECRET: "303132333435363738393031323334353637383930313233343536373839303132"
      # Midnight NodeのWebSocket URL（テストネット）
      APP__INFRA__NODE__URL: "wss://rpc.testnet-02.midnight.network"
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8088/ready"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 60s
